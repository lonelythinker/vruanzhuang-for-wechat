<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		<meta content="email=no" name="format-detection" />
		<script type="text/javascript" src="js/vue.js"></script>
		<script type="text/javascript" src="js/app.js"></script>
		<script type="text/javascript" src="js/global.js"></script>
		<script type="text/javascript" src="js/mui.min.js"></script>

		<link rel="stylesheet" href="css/mui.min.css" />
		<link rel="stylesheet" href="css/app.css" />
		<link rel="stylesheet" href="css/order.css" />
		<title>微软装</title>
	</head>
	<style>
		.mui-input-row.mui-search .mui-icon-clear {
			top: 10px!important;
		}
		
		.mui-search:before {
			top: 10px;
		}
		
		.mui-search .mui-placeholder {
			line-height: 39px;
		}
		
		body {
			background-color: #fff;
		}
	</style>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title"><div class="mui-input-row mui-search">
					<input type="search" class="mui-input-clear" placeholder="搜索">
				</div></h1>
		</header>

		<div class="mui-content">
			<div class="mui-slider-item">
				<ul class="mui-table-view mui-grid-view mui-grid-9" id="class">
					<li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3" v-for="item in items[0].children">
						<span class="class" data-id="{{item.id}}" root-id="{{item.root}}" name="{{item.name}}">
							<img src="images/app-logo.png" width="100%" height="100%">
							<div class="mui-media-body" class="name">{{item.name}}</div>
						</span>
					</li>

				</ul>
			</div>
		</div>
	</body>
	<script>
		mui.init();
		var url = window.location.search;
		var spacesortid = url.substring(url.lastIndexOf('=') + 1, url.length);
		mui.ajax(apiurl + 'tags/multi-children?name=产品分类', {
			dataType: 'json',
			type: 'get',
			timeout: 6000,
			success: function(data) {
				if (data.success == true) {
					taglist = data.data;
					console.log(JSON.stringify(taglist));
					new Vue({
						el: '#class',
						data: taglist,
						compiled: function() {
							mui('#class').on('tap', '.class', function() {
								classid = this.getAttribute('data-id');
								rootid = this.getAttribute('root-id');
								name = this.getAttribute('name');
								selectproduct = [{
									"id": rootid,
									"name": "产品分类",
									"children": [{
										"id": classid,
										"name": name
									}]
								}];
								console.log(JSON.stringify(selectproduct))
								mui.ajax(apiurl + 'schemes/match', {
									data: {
										'tags': selectproduct
									},
									dataType: 'json',
									type: 'post',
									timeout: 6000,
									success: function(data) {
										if (data.success == true) {
											console.log(JSON.stringify(data.data))
										} else {
											mui.alert("获取方案失败，请稍候再试");
										}
									},
									error: function(xhr, textStatus, errorThrown) {
										mui.alert("网络连接失败，请稍候再试");
									}
								});
//								mui.openWindow({
//									url: "product-in-class.html",
//									id: "productinclass",
//									show: {
//										aniShow: 'zoom-fade-out',
//										duration: 300
//									}
//								});
								return;
							});
						}
					})
				} else {
					mui.alert("获取标签失败，请稍候再试");
					stopload();
				}
			},
			error: function(xhr, textStatus, errorThrown) {
				mui.alert("网络连接失败，请稍候再试");
				stopload();
			}
		});
	</script>

</html>