<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		<meta content="email=no" name="format-detection" />
		<link rel="stylesheet" href="css/mui.min.css" />
		<link rel="stylesheet" href="css/app.css" />
		<link rel="stylesheet" href="css/match.css" />
		<title>微软装</title>
	</head>

	<body>
		<div id="load">
			<div class="loading"></div>
			<div class="loading-text"><img src="images/load.gif" width="25px">加载中，请稍候...</div>
		</div>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<!--<a class="icon-left-nav mui-icon mui-pull-right skip" href="match-step3.html">跳过></a>-->
		</header>
		<div class="mui-content">
			<div class="title2">
				<p>请选择几个你喜欢的</p>装修风格</div>
			<div class="style-list">
				<div class="circle grid-1"><span>现代</span></div>
				<div class="circle grid-2"><span>地中海</span></div>
				<div class="circle grid-3"><span>欧式</span></div>
				<div class="circle grid-4"><span>中式</span></div>
				<div class="circle grid-5"><span>田园</span></div>
				<div class="circle grid-6"><span>美式</span></div>
				<div class="circle grid-7"><span>新古典</span></div>
			</div>

			<div class="title2">
				装修颜色</div>
			<div class="colorselect" id="colorlist">
				<span class="color" v-for="color in colors" id="{{color.color_id}}" data="{{color.color_code}}">{{color.color_name}}</span>
			</div>

			<div id="next-step">选好了，下一步></div>
		</div>

	</body>
	<script src="js/app.js"></script>
	<script src="js/global.js"></script>
	<script src="js/mui.min.js"></script>
	<script src="js/vue.js"></script>
	<script>
		use strict;
		var stylelist = [{
			"name": "现代",
			"id": 17
		}, {
			"name": "地中海",
			"id": 23
		}, {
			"name": "欧式",
			"id": 18
		}, {
			"name": "中式",
			"id": 19
		}, {
			"name": "田园",
			"id": 20
		}, {
			"name": "美式",
			"id": 22
		}, {
			"name": "新古典",
			"id": 23
		}];
		var colorstyle = [{
			"color_name": "蓝",
			"color_id": 29,
			"color_code": "#B0E2FF"
		}, {
			"color_name": "绿",
			"color_id": 27,
			"color_code": "#BCEE68"
		}, {
			"color_name": "黄",
			"color_id": 26,
			"color_code": "#EEEE00"
		}, {
			"color_name": "橙",
			"color_id": 25,
			"color_code": "#EEAD0E"
		}, {
			"color_name": "红",
			"color_id": 24,
			"color_code": "#FF4500"
		}, {
			"color_name": "粉",
			"color_id": 30,
			"color_code": "#FFBBFF"
		}, {
			"color_name": "咖",
			"color_id": 47,
			"color_code": "#B8860B"
		}, {
			"color_name": "白",
			"color_id": 28,
			"color_code": "#F3F3F3"
		}, {
			"color_name": "灰",
			"color_id": 46,
			"color_code": "#E0E0E0"
		}];
		var colorselect = [];
		var colorselectid = [];
		var stylename;
		var styleid;
		mui.ready(function() {
			colorlist = new Vue({
				el: '#colorlist',
				data: {
					'colors': colorstyle
				},
				compiled: function() {
					stopload();
				}
			});
			changecolor();
		})
		mui('.style-list').on('tap', '.circle', function() {
			selectstyle(this);
			return;
		});
		mui('#colorlist').on('tap', '.color', function() {
			selectcolor(this);
			return;
		});
		document.getElementById('next-step').addEventListener('tap', function() {
			!stylename ? mui.alert('请选择风格', '微软装') : !colorselect.length ? mui.alert('请选择颜色', '微软装') : next();
		});

		function selectstyle(e) {
			borthers = e.parentNode.getElementsByClassName("circle");
			for (i = 0; i < borthers.length; i++) {
				borthers[i].getElementsByTagName("span")[0].style.backgroundColor = 'rgba(255,255,255,0.6)'
			}
			e.getElementsByTagName("span")[0].style.backgroundColor = 'rgba(255,255,255,0)'
			sortid = e.className.split("grid-")[1] - 1;
			stylename = stylelist[sortid].name;
			styleid = stylelist[sortid].id;
		}

		function selectcolor(e) {
			!e.style.border ? (e.style.border = '2px solid#0000EE', colorselect.push(e.innerHTML), colorselectid.push(e.id)) : (e.style.border = '', colorselect.remove(e.innerHTML), colorselectid.remove(e.id))
		}

		function changecolor() {
			item = document.getElementsByClassName("color");
			for (let i = 0; i < item.length; i++) {
				item[i].style.backgroundColor = item[i].getAttribute('data');
			}
		}

		function next() {
			var colorchildren = [];
			IC = JSON.parse(localStorage.IC);
			IC.push({
				"id": 10,
				"name": "装修风格",
				"children": {
					"id": styleid,
					"name": stylename
				}
			});
			for (let i = 0; i < colorselect.length; i++) {
				colorchildren.push({
					"id": colorselectid[i],
					"name": colorselect[i]
				});
			}
			IC.push({
				"id": 11,
				"name": "装修色彩",
				"children": colorchildren
			});
			localStorage.IC = JSON.stringify(IC);
			location.href = "match-step3.html";
		}
	</script>

</html>